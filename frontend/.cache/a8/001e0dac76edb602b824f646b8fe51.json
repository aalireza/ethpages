{"id":"node_modules/uport-lite/lib/index.js","dependencies":[{"name":"/Users/sashavol/Misc/ethdenver-keybook/frontend/package.json","includedInParent":true,"mtime":1550371955498},{"name":"/Users/sashavol/Misc/ethdenver-keybook/frontend/node_modules/uport-lite/package.json","includedInParent":true,"mtime":1550368277431},{"name":"base-x","loc":{"line":5,"column":18},"parent":"/Users/sashavol/Misc/ethdenver-keybook/frontend/node_modules/uport-lite/lib/index.js","resolved":"/Users/sashavol/Misc/ethdenver-keybook/frontend/node_modules/base-x/index.js"},{"name":"xmlhttprequest","loc":{"line":7,"column":85},"parent":"/Users/sashavol/Misc/ethdenver-keybook/frontend/node_modules/uport-lite/lib/index.js","resolved":"/usr/local/lib/node_modules/parcel-bundler/src/builtins/_empty.js"}],"generated":{"js":"'use strict';\n\nvar BASE58 = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';\nvar base58 = require('base-x')(BASE58);\nvar hex = require('base-x')('0123456789abcdef');\n\nvar XMLHttpRequest = typeof window !== 'undefined' ? window.XMLHttpRequest : require('xmlhttprequest').XMLHttpRequest;\n\nvar functionSignature = '0x447885f0';\n\n// Legacy\nvar getAttributesData = '0x446d5aa4000000000000000000000000';\n\nfunction http(opts, callback) {\n  var request = new XMLHttpRequest(); // eslint-disable-line\n  var options = opts || {};\n\n  request.onreadystatechange = function () {\n    if (request.readyState === 4 && request.timeout !== 1) {\n      if (request.status !== 200) {\n        callback(new Error('[uport-lite] status ' + request.status + ': ' + request.responseText));\n      } else {\n        try {\n          callback(null, JSON.parse(request.responseText));\n        } catch (jsonError) {\n          callback(new Error('[uport-lite] while parsing data: \\'' + String(request.responseText) + '\\', error: ' + String(jsonError)));\n        }\n      }\n    }\n  };\n  if (options.data) {\n    request.open('POST', opts.uri);\n  } else {\n    request.open('GET', opts.uri);\n  }\n\n  if (options.accept) {\n    request.setRequestHeader('accept', options.accept);\n  }\n\n  if (options.data) {\n    request.setRequestHeader('Content-Type', 'application/json');\n    request.send(JSON.stringify(options.data));\n  } else {\n    request.send();\n  }\n}\n\nfunction registryEncodingToIPFS(hexStr) {\n  return base58.encode(hex.decode('1220' + hexStr.slice(2)));\n}\n\n// to avoid adding further dependencies we are not verifying checksum\nfunction eaeDecode(encoded) {\n  var data = base58.decode(encoded);\n  var netLength = data.length - 24;\n  var network = data.slice(1, netLength);\n  var address = data.slice(netLength, 20 + netLength);\n  return {\n    network: '0x' + hex.encode(network),\n    address: '0x' + hex.encode(address)\n  };\n}\n\nvar defaultNetworks = {\n  '0x1': {\n    registry: '0xab5c8051b9a1df1aab0149f8b0630848b7ecabf6',\n    rpcUrl: 'https://mainnet.infura.io'\n  },\n  '0x3': {\n    registry: '0x41566e3a081f5032bdcad470adb797635ddfe1f0',\n    rpcUrl: 'https://ropsten.infura.io'\n  },\n  '0x2a': {\n    registry: '0x5f8e9351dc2d238fb878b6ae43aa740d62fc9758',\n    rpcUrl: 'https://kovan.infura.io'\n    // },\n    // '0x16B2': {\n    //   registry: '',\n    //   rpcUrl: 'https://infuranet.infura.io'\n  },\n  '0x4': {\n    registry: '0x2cc31912b2b0f3075a87b3640923d45a26cef3ee',\n    rpcUrl: 'https://rinkeby.infura.io'\n  }\n};\n\nfunction toBase58(hexStr) {\n  return base58.encode(hex.decode(hexStr));\n}\n\nfunction UportLite() {\n  var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var infuraKey = opts.infuraKey || 'uport-lite-library';\n  var ipfsGw = opts.ipfsGw || 'https://ipfs.infura.io/ipfs/';\n  var networks = opts.networks ? Object.assign({}, defaultNetworks, opts.networks) : defaultNetworks;\n\n  function asciiToHex(string, delim) {\n    return string.split('').map(function (c) {\n      return ('0' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(delim || '');\n  }\n\n  function pad(pad, str, padLeft) {\n    if (typeof str === 'undefined') {\n      return pad;\n    }\n    if (padLeft) {\n      return (pad + str).slice(-pad.length);\n    } else {\n      return (str + pad).substring(0, pad.length);\n    }\n  }\n\n  function encodeFunctionCall(functionSignature, registrationIdentifier, issuer, subject) {\n    var callString = functionSignature;\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', asciiToHex(registrationIdentifier));\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', issuer.slice(2), true);\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', subject.slice(2), true);\n    return callString;\n  }\n\n  // TODO remove once feasible\n  function callLegacyRegistry(address, callback) {\n    var rpcUrl = 'https://ropsten.infura.io/' + infuraKey;\n    if (!address) return callback(null);\n    return http({\n      uri: rpcUrl,\n      accept: 'application/json',\n      data: {\n        method: 'eth_call',\n        params: [{ to: '0xb9C1598e24650437a3055F7f66AC1820c419a679', data: getAttributesData + address.slice(2) }, 'latest'],\n        id: 1,\n        jsonrpc: '2.0'\n      }\n    }, function (error, response) {\n      if (error) return callback(error);\n      if (response.error) return callback(response.error);\n      var hexHash = response.result.slice(130).slice(0, 68);\n      return callback(null, toBase58(hexHash));\n    });\n  }\n\n  function callRegistry(registrationIdentifier, issuerId, subjectId, callback) {\n    var issuer = eaeDecode(issuerId);\n    var subject = eaeDecode(subjectId);\n    if (issuer.network !== subject.network) {\n      callback(new Error('Issuer and subject must be on the same network'));\n      return;\n    }\n    if (!networks[issuer.network]) {\n      callback(new Error('Network id ' + issuer.network + ' is not configured'));\n      return;\n    }\n    var rpcUrl = networks[issuer.network].rpcUrl;\n    var registryAddress = networks[issuer.network].registry;\n    var callString = encodeFunctionCall(functionSignature, registrationIdentifier, issuer.address, subject.address);\n    return http({\n      uri: rpcUrl + '/' + infuraKey,\n      accept: 'application/json',\n      data: {\n        method: 'eth_call',\n        params: [{ to: registryAddress, data: callString }, 'latest'],\n        id: 1,\n        jsonrpc: '2.0'\n      }\n    }, function (error, response) {\n      if (error) return callback(error);\n      if (response.error) return callback(response.error);\n      if (response.result == 0) return callback(error);\n      return callback(null, registryEncodingToIPFS(response.result));\n    });\n  }\n\n  function fetchIpfs(ipfsHash, callback) {\n    if (!ipfsHash || ipfsHash === '0x') return callback();\n    return http({ uri: '' + ipfsGw + ipfsHash }, callback);\n  }\n\n  function get(issuer, callback, subjectAddress) {\n    var registrationIdentifier = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'uPortProfileIPFS1220';\n\n    if (!issuer) return callback(null);\n    var subject = subjectAddress || issuer;\n\n    if (issuer.match(/0x[0-9a-fA-F]{40}/)) {\n      return callLegacyRegistry(issuer, function (error, ipfsHash) {\n        if (error) return callback(error);\n        fetchIpfs(ipfsHash, callback);\n      });\n    } else {\n      return callRegistry(registrationIdentifier, issuer, subject, function (error, ipfsHash) {\n        if (error) return callback(error);\n        fetchIpfs(ipfsHash, callback);\n      });\n    }\n  }\n  return get;\n}\n\nmodule.exports = UportLite;","map":{"mappings":[{"source":"node_modules/uport-lite/lib/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":2,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":3,"column":0},"generated":{"line":3,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":4,"column":0},"generated":{"line":4,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":5,"column":0},"generated":{"line":5,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":6,"column":0},"generated":{"line":6,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":7,"column":0},"generated":{"line":7,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":8,"column":0},"generated":{"line":8,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":9,"column":0},"generated":{"line":9,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":10,"column":0},"generated":{"line":10,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":11,"column":0},"generated":{"line":11,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":12,"column":0},"generated":{"line":12,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":13,"column":0},"generated":{"line":13,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":14,"column":0},"generated":{"line":14,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":15,"column":0},"generated":{"line":15,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":16,"column":0},"generated":{"line":16,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":17,"column":0},"generated":{"line":17,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":18,"column":0},"generated":{"line":18,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":19,"column":0},"generated":{"line":19,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":20,"column":0},"generated":{"line":20,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":21,"column":0},"generated":{"line":21,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":22,"column":0},"generated":{"line":22,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":23,"column":0},"generated":{"line":23,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":24,"column":0},"generated":{"line":24,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":25,"column":0},"generated":{"line":25,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":26,"column":0},"generated":{"line":26,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":27,"column":0},"generated":{"line":27,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":28,"column":0},"generated":{"line":28,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":29,"column":0},"generated":{"line":29,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":30,"column":0},"generated":{"line":30,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":31,"column":0},"generated":{"line":31,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":32,"column":0},"generated":{"line":32,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":33,"column":0},"generated":{"line":33,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":34,"column":0},"generated":{"line":34,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":35,"column":0},"generated":{"line":35,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":36,"column":0},"generated":{"line":36,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":37,"column":0},"generated":{"line":37,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":38,"column":0},"generated":{"line":38,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":39,"column":0},"generated":{"line":39,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":40,"column":0},"generated":{"line":40,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":41,"column":0},"generated":{"line":41,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":42,"column":0},"generated":{"line":42,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":43,"column":0},"generated":{"line":43,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":44,"column":0},"generated":{"line":44,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":45,"column":0},"generated":{"line":45,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":46,"column":0},"generated":{"line":46,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":47,"column":0},"generated":{"line":47,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":48,"column":0},"generated":{"line":48,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":49,"column":0},"generated":{"line":49,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":50,"column":0},"generated":{"line":50,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":51,"column":0},"generated":{"line":51,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":52,"column":0},"generated":{"line":52,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":53,"column":0},"generated":{"line":53,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":54,"column":0},"generated":{"line":54,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":55,"column":0},"generated":{"line":55,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":56,"column":0},"generated":{"line":56,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":57,"column":0},"generated":{"line":57,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":58,"column":0},"generated":{"line":58,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":59,"column":0},"generated":{"line":59,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":60,"column":0},"generated":{"line":60,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":61,"column":0},"generated":{"line":61,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":62,"column":0},"generated":{"line":62,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":63,"column":0},"generated":{"line":63,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":64,"column":0},"generated":{"line":64,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":65,"column":0},"generated":{"line":65,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":66,"column":0},"generated":{"line":66,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":67,"column":0},"generated":{"line":67,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":68,"column":0},"generated":{"line":68,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":69,"column":0},"generated":{"line":69,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":70,"column":0},"generated":{"line":70,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":71,"column":0},"generated":{"line":71,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":72,"column":0},"generated":{"line":72,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":73,"column":0},"generated":{"line":73,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":74,"column":0},"generated":{"line":74,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":75,"column":0},"generated":{"line":75,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":76,"column":0},"generated":{"line":76,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":77,"column":0},"generated":{"line":77,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":78,"column":0},"generated":{"line":78,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":79,"column":0},"generated":{"line":79,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":80,"column":0},"generated":{"line":80,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":81,"column":0},"generated":{"line":81,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":82,"column":0},"generated":{"line":82,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":83,"column":0},"generated":{"line":83,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":84,"column":0},"generated":{"line":84,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":85,"column":0},"generated":{"line":85,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":86,"column":0},"generated":{"line":86,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":87,"column":0},"generated":{"line":87,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":88,"column":0},"generated":{"line":88,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":89,"column":0},"generated":{"line":89,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":90,"column":0},"generated":{"line":90,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":91,"column":0},"generated":{"line":91,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":92,"column":0},"generated":{"line":92,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":93,"column":0},"generated":{"line":93,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":94,"column":0},"generated":{"line":94,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":95,"column":0},"generated":{"line":95,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":96,"column":0},"generated":{"line":96,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":97,"column":0},"generated":{"line":97,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":98,"column":0},"generated":{"line":98,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":99,"column":0},"generated":{"line":99,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":100,"column":0},"generated":{"line":100,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":101,"column":0},"generated":{"line":101,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":102,"column":0},"generated":{"line":102,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":103,"column":0},"generated":{"line":103,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":104,"column":0},"generated":{"line":104,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":105,"column":0},"generated":{"line":105,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":106,"column":0},"generated":{"line":106,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":107,"column":0},"generated":{"line":107,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":108,"column":0},"generated":{"line":108,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":109,"column":0},"generated":{"line":109,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":110,"column":0},"generated":{"line":110,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":111,"column":0},"generated":{"line":111,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":112,"column":0},"generated":{"line":112,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":113,"column":0},"generated":{"line":113,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":114,"column":0},"generated":{"line":114,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":115,"column":0},"generated":{"line":115,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":116,"column":0},"generated":{"line":116,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":117,"column":0},"generated":{"line":117,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":118,"column":0},"generated":{"line":118,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":119,"column":0},"generated":{"line":119,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":120,"column":0},"generated":{"line":120,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":121,"column":0},"generated":{"line":121,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":122,"column":0},"generated":{"line":122,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":123,"column":0},"generated":{"line":123,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":124,"column":0},"generated":{"line":124,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":125,"column":0},"generated":{"line":125,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":126,"column":0},"generated":{"line":126,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":127,"column":0},"generated":{"line":127,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":128,"column":0},"generated":{"line":128,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":129,"column":0},"generated":{"line":129,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":130,"column":0},"generated":{"line":130,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":131,"column":0},"generated":{"line":131,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":132,"column":0},"generated":{"line":132,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":133,"column":0},"generated":{"line":133,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":134,"column":0},"generated":{"line":134,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":135,"column":0},"generated":{"line":135,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":136,"column":0},"generated":{"line":136,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":137,"column":0},"generated":{"line":137,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":138,"column":0},"generated":{"line":138,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":139,"column":0},"generated":{"line":139,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":140,"column":0},"generated":{"line":140,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":141,"column":0},"generated":{"line":141,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":142,"column":0},"generated":{"line":142,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":143,"column":0},"generated":{"line":143,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":144,"column":0},"generated":{"line":144,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":145,"column":0},"generated":{"line":145,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":146,"column":0},"generated":{"line":146,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":147,"column":0},"generated":{"line":147,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":148,"column":0},"generated":{"line":148,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":149,"column":0},"generated":{"line":149,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":150,"column":0},"generated":{"line":150,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":151,"column":0},"generated":{"line":151,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":152,"column":0},"generated":{"line":152,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":153,"column":0},"generated":{"line":153,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":154,"column":0},"generated":{"line":154,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":155,"column":0},"generated":{"line":155,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":156,"column":0},"generated":{"line":156,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":157,"column":0},"generated":{"line":157,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":158,"column":0},"generated":{"line":158,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":159,"column":0},"generated":{"line":159,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":160,"column":0},"generated":{"line":160,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":161,"column":0},"generated":{"line":161,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":162,"column":0},"generated":{"line":162,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":163,"column":0},"generated":{"line":163,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":164,"column":0},"generated":{"line":164,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":165,"column":0},"generated":{"line":165,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":166,"column":0},"generated":{"line":166,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":167,"column":0},"generated":{"line":167,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":168,"column":0},"generated":{"line":168,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":169,"column":0},"generated":{"line":169,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":170,"column":0},"generated":{"line":170,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":171,"column":0},"generated":{"line":171,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":172,"column":0},"generated":{"line":172,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":173,"column":0},"generated":{"line":173,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":174,"column":0},"generated":{"line":174,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":175,"column":0},"generated":{"line":175,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":176,"column":0},"generated":{"line":176,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":177,"column":0},"generated":{"line":177,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":178,"column":0},"generated":{"line":178,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":179,"column":0},"generated":{"line":179,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":180,"column":0},"generated":{"line":180,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":181,"column":0},"generated":{"line":181,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":182,"column":0},"generated":{"line":182,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":183,"column":0},"generated":{"line":183,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":184,"column":0},"generated":{"line":184,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":185,"column":0},"generated":{"line":185,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":186,"column":0},"generated":{"line":186,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":187,"column":0},"generated":{"line":187,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":188,"column":0},"generated":{"line":188,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":189,"column":0},"generated":{"line":189,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":190,"column":0},"generated":{"line":190,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":191,"column":0},"generated":{"line":191,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":192,"column":0},"generated":{"line":192,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":193,"column":0},"generated":{"line":193,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":194,"column":0},"generated":{"line":194,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":195,"column":0},"generated":{"line":195,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":196,"column":0},"generated":{"line":196,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":197,"column":0},"generated":{"line":197,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":198,"column":0},"generated":{"line":198,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":199,"column":0},"generated":{"line":199,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":200,"column":0},"generated":{"line":200,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":201,"column":0},"generated":{"line":201,"column":0}},{"source":"node_modules/uport-lite/lib/index.js","original":{"line":202,"column":0},"generated":{"line":202,"column":0}}],"sources":{"node_modules/uport-lite/lib/index.js":"'use strict';\n\nvar BASE58 = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz';\nvar base58 = require('base-x')(BASE58);\nvar hex = require('base-x')('0123456789abcdef');\n\nvar XMLHttpRequest = typeof window !== 'undefined' ? window.XMLHttpRequest : require('xmlhttprequest').XMLHttpRequest;\n\nvar functionSignature = '0x447885f0';\n\n// Legacy\nvar getAttributesData = '0x446d5aa4000000000000000000000000';\n\nfunction http(opts, callback) {\n  var request = new XMLHttpRequest(); // eslint-disable-line\n  var options = opts || {};\n\n  request.onreadystatechange = function () {\n    if (request.readyState === 4 && request.timeout !== 1) {\n      if (request.status !== 200) {\n        callback(new Error('[uport-lite] status ' + request.status + ': ' + request.responseText));\n      } else {\n        try {\n          callback(null, JSON.parse(request.responseText));\n        } catch (jsonError) {\n          callback(new Error('[uport-lite] while parsing data: \\'' + String(request.responseText) + '\\', error: ' + String(jsonError)));\n        }\n      }\n    }\n  };\n  if (options.data) {\n    request.open('POST', opts.uri);\n  } else {\n    request.open('GET', opts.uri);\n  }\n\n  if (options.accept) {\n    request.setRequestHeader('accept', options.accept);\n  }\n\n  if (options.data) {\n    request.setRequestHeader('Content-Type', 'application/json');\n    request.send(JSON.stringify(options.data));\n  } else {\n    request.send();\n  }\n}\n\nfunction registryEncodingToIPFS(hexStr) {\n  return base58.encode(hex.decode('1220' + hexStr.slice(2)));\n}\n\n// to avoid adding further dependencies we are not verifying checksum\nfunction eaeDecode(encoded) {\n  var data = base58.decode(encoded);\n  var netLength = data.length - 24;\n  var network = data.slice(1, netLength);\n  var address = data.slice(netLength, 20 + netLength);\n  return {\n    network: '0x' + hex.encode(network),\n    address: '0x' + hex.encode(address)\n  };\n}\n\nvar defaultNetworks = {\n  '0x1': {\n    registry: '0xab5c8051b9a1df1aab0149f8b0630848b7ecabf6',\n    rpcUrl: 'https://mainnet.infura.io'\n  },\n  '0x3': {\n    registry: '0x41566e3a081f5032bdcad470adb797635ddfe1f0',\n    rpcUrl: 'https://ropsten.infura.io'\n  },\n  '0x2a': {\n    registry: '0x5f8e9351dc2d238fb878b6ae43aa740d62fc9758',\n    rpcUrl: 'https://kovan.infura.io'\n    // },\n    // '0x16B2': {\n    //   registry: '',\n    //   rpcUrl: 'https://infuranet.infura.io'\n  },\n  '0x4': {\n    registry: '0x2cc31912b2b0f3075a87b3640923d45a26cef3ee',\n    rpcUrl: 'https://rinkeby.infura.io'\n  }\n};\n\nfunction toBase58(hexStr) {\n  return base58.encode(hex.decode(hexStr));\n}\n\nfunction UportLite() {\n  var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var infuraKey = opts.infuraKey || 'uport-lite-library';\n  var ipfsGw = opts.ipfsGw || 'https://ipfs.infura.io/ipfs/';\n  var networks = opts.networks ? Object.assign({}, defaultNetworks, opts.networks) : defaultNetworks;\n\n  function asciiToHex(string, delim) {\n    return string.split('').map(function (c) {\n      return ('0' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(delim || '');\n  }\n\n  function pad(pad, str, padLeft) {\n    if (typeof str === 'undefined') {\n      return pad;\n    }\n    if (padLeft) {\n      return (pad + str).slice(-pad.length);\n    } else {\n      return (str + pad).substring(0, pad.length);\n    }\n  }\n\n  function encodeFunctionCall(functionSignature, registrationIdentifier, issuer, subject) {\n    var callString = functionSignature;\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', asciiToHex(registrationIdentifier));\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', issuer.slice(2), true);\n    callString += pad('0000000000000000000000000000000000000000000000000000000000000000', subject.slice(2), true);\n    return callString;\n  }\n\n  // TODO remove once feasible\n  function callLegacyRegistry(address, callback) {\n    var rpcUrl = 'https://ropsten.infura.io/' + infuraKey;\n    if (!address) return callback(null);\n    return http({\n      uri: rpcUrl,\n      accept: 'application/json',\n      data: {\n        method: 'eth_call',\n        params: [{ to: '0xb9C1598e24650437a3055F7f66AC1820c419a679', data: getAttributesData + address.slice(2) }, 'latest'],\n        id: 1,\n        jsonrpc: '2.0'\n      }\n    }, function (error, response) {\n      if (error) return callback(error);\n      if (response.error) return callback(response.error);\n      var hexHash = response.result.slice(130).slice(0, 68);\n      return callback(null, toBase58(hexHash));\n    });\n  }\n\n  function callRegistry(registrationIdentifier, issuerId, subjectId, callback) {\n    var issuer = eaeDecode(issuerId);\n    var subject = eaeDecode(subjectId);\n    if (issuer.network !== subject.network) {\n      callback(new Error('Issuer and subject must be on the same network'));\n      return;\n    }\n    if (!networks[issuer.network]) {\n      callback(new Error('Network id ' + issuer.network + ' is not configured'));\n      return;\n    }\n    var rpcUrl = networks[issuer.network].rpcUrl;\n    var registryAddress = networks[issuer.network].registry;\n    var callString = encodeFunctionCall(functionSignature, registrationIdentifier, issuer.address, subject.address);\n    return http({\n      uri: rpcUrl + '/' + infuraKey,\n      accept: 'application/json',\n      data: {\n        method: 'eth_call',\n        params: [{ to: registryAddress, data: callString }, 'latest'],\n        id: 1,\n        jsonrpc: '2.0'\n      }\n    }, function (error, response) {\n      if (error) return callback(error);\n      if (response.error) return callback(response.error);\n      if (response.result == 0) return callback(error);\n      return callback(null, registryEncodingToIPFS(response.result));\n    });\n  }\n\n  function fetchIpfs(ipfsHash, callback) {\n    if (!ipfsHash || ipfsHash === '0x') return callback();\n    return http({ uri: '' + ipfsGw + ipfsHash }, callback);\n  }\n\n  function get(issuer, callback, subjectAddress) {\n    var registrationIdentifier = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'uPortProfileIPFS1220';\n\n    if (!issuer) return callback(null);\n    var subject = subjectAddress || issuer;\n\n    if (issuer.match(/0x[0-9a-fA-F]{40}/)) {\n      return callLegacyRegistry(issuer, function (error, ipfsHash) {\n        if (error) return callback(error);\n        fetchIpfs(ipfsHash, callback);\n      });\n    } else {\n      return callRegistry(registrationIdentifier, issuer, subject, function (error, ipfsHash) {\n        if (error) return callback(error);\n        fetchIpfs(ipfsHash, callback);\n      });\n    }\n  }\n  return get;\n}\n\nmodule.exports = UportLite;"},"lineCount":202}},"hash":"68efa5dc50b330166471b82fa7a22eb1","cacheData":{"env":{}}}